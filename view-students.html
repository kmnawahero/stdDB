<!DOCTYPE html>
<html>
<head>
  <title>View Students</title>
  <style>
    body{
      font-family: Arial, sans-serif;
      background:#f5f5f5;
    }

    h2{
      text-align:center;
    }

    #studentsContainer{
      display:flex;
      flex-wrap:wrap;
      justify-content:center;
    }

    .student-card{
      background:white;
      border-radius:10px;
      padding:15px;
      margin:15px;
      width:220px;
      text-align:center;
      box-shadow:0 4px 8px rgba(0,0,0,0.1);
    }

    .student-card img{
      width:120px;
      height:120px;
      object-fit:cover;
      border-radius:50%;
      margin-bottom:10px;
    }

    .student-card p{
      margin:4px 0;
    }
  </style>
</head>
<body>

<h2>All Students</h2>
<div id="studentsContainer"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBGcwITCN1Vq2Febg1CaOyyaNxh8xoJEA0",
  authDomain: "student-db-1b4f8.firebaseapp.com",
  projectId: "student-db-1b4f8",
  storageBucket: "student-db-1b4f8.firebasestorage.app",
  messagingSenderId: "936851470891",
  appId: "1:936851470891:web:031da108047caacfa9c86e",
  measurementId: "G-8G4F3WRKJ5"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

async function fetchStudents(){

  const container = document.getElementById("studentsContainer");
  container.innerHTML = "";

  try{
    const snapshot = await getDocs(collection(db,"students"));

    snapshot.forEach(doc=>{
      const data = doc.data();

      const div = document.createElement("div");
      div.className = "student-card";

      div.innerHTML = `
        <img src="data:image/jpeg;base64,${data.photoBase64}">
        <h3>${data.name}</h3>
        <p><b>Class:</b> ${data.class}</p>
        <p><b>Room:</b> ${data.roomNo}</p>
        <p><b>Status:</b> ${data.status}</p>
      `;

      container.appendChild(div);
    });

  } catch(error){
    console.error(error);
    alert("Error loading students");
  }
}

fetchStudents();
</script>

</body>
</html>
